<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Data Mining 2</title>

    <!-- Bootstrap core CSS -->
    <link href="../../../style/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../../../style/codehilite/css/default.css" rel="stylesheet">
    <link href="../../../style/misc/css/module.css" rel="stylesheet">
    <link href="../../../style/misc/css/practical.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

	<script type="text/javascript"
	  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>

  </head>

<body>

	<!-- Fixed navbar -->
	<div class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			
			
	    	<div class="collapse navbar-collapse">

				<ul class="nav navbar-nav navbar-left">
					<!-- Moodle -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://moodle.wit.ie/course/view.php?id=192024" target="_blank"><img height="18pt" src="../../../style/misc/img/moodle_logo_on_blue.gif" /></a>
						</div>						
					</li>
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://moodle.wit.ie/course/view.php?id=192024" target="_blank"><img height="18pt" src="../../../style/misc/img/slack_logo.png" /></a>
						</div>						
					</li>
				</ul>

	      		<ul class="nav navbar-nav navbar-right">

					<!-- module home -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="../../../index.html"><span class="glyphicon glyphicon-home"></span></a>
						</div>						
					</li>
					
					<!-- topics -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-list-alt"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Topics</li>
										
										<li >
											<a href="../../../topics/01-Module_Introduction/index.html">Module Introduction</a>
										</li>
										
										<li >
											<a href="../../../topics/02-Feature_Engineering/index.html">Feature Engineering</a>
										</li>
										
										<li >
											<a href="../../../topics/03-Review_of_Model_Building/index.html">Review of Model Building</a>
										</li>
										
										<li >
											<a href="../../../topics/04-Hyperparameter_Tuning/index.html">Hyperparameter Tuning</a>
										</li>
										
										<li class="active">
											<a href="../../../topics/05-Ensemble_Learning/index.html">Ensemble Learning</a>
										</li>
										
										<li >
											<a href="../../../topics/06-Time_Series_Mining/index.html">Time Series Mining</a>
										</li>
										
										<li >
											<a href="../../../topics/21-Assignments/index.html">Assignments</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>

					<!-- resources -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-th-list"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Resources</li>
										
										<li >
											<a href="../../../topics/05-Ensemble_Learning/index.html#01-Introduction_to_Ensemble_Learning">Introduction to Ensemble Learning</a>
										</li>
										
										<li class="active">
											<a href="../../../topics/05-Ensemble_Learning/index.html#21-Practical_05_-_Ensemble_Learners">Practical 05 - Ensemble Learners</a>
										</li>
										
										<li >
											<a href="../../../topics/05-Ensemble_Learning/index.html#22-Practical_06_-_Stacked_Models">Practical 06 - Stacked Models</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>
								
					<!-- pages-->
	        		<li>
						<div class="navbar-collapse collapse" id="c">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span>Datasets</span
									</a>
									<ul class="dropdown-menu" role="menu">
										
										<li >
											<a href="00-Outline.html">Outline</a>
										</li>
										
										<li class="active">
											<a href="01-Datasets.html">Datasets</a>
										</li>
										
										<li >
											<a href="02-Preprocessing.html">Preprocessing</a>
										</li>
										
										<li >
											<a href="03-AdaBoost.html">AdaBoost</a>
										</li>
										
										<li >
											<a href="04-Gradient_Boosting.html">Gradient Boosting</a>
										</li>
										
										<li >
											<a href="05-XGBoost.html">XGBoost</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li> 
					
	        	</ul>
			</div>
		</div>
	</div>

	<!-- contents -->
	<div class="container">
		
		<ul class="pager">
			
			<li class="previous"><a href="00-Outline.html">&larr; Previous (Outline)</a></li>
			
			
			
			<li class="next"><a href="02-Preprocessing.html">Next (Preprocessing) &rarr;</a></li>
			
		</ul>
		
		<h1>Datasets</h1>
<p>Ideally I want you to compare the ensemble learners using a dataset complicated enough to demonstrate the differences between the learners. 
The MINST dataset is ideal for this. 
Unfortunately, the training and hyper-parameter optimisation is too long (15 min+), so we are going to use a smaller dataset (picked semi-randomly using the <code>opemml</code> package.)</p>
<h2>Details</h2>
<p>Install <code>openml</code> package (if not installed already). This package is an interface for OpenML, an online platform for open science collaboration in machine learning. It can be used to download or upload OpenML data such as datasets and machine learning experiment results.</p>
<p>Import package and get list of datasets</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">openml.datasets</span> <span class="kn">import</span> <span class="n">list_datasets</span><span class="p">,</span> <span class="n">get_dataset</span>
<span class="n">df_openml</span> <span class="o">=</span> <span class="n">list_datasets</span><span class="p">(</span><span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;dataframe&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>You should get a dataframe of 3494 rows </p>
<figure>
<img width="90%" src="files/df_opemml.png">
</figure>

<p>Searching using query</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>df_openml.loc[df_openml.name.str.contains(&quot;mnist&quot;)]
</code></pre></div>
</td></tr></table>
<p>returns two MNIST datasets. The column <code>did</code> will be used to fetch the dataset using function <code>get_dataset</code>.</p>
<p>The dataset that we will look at are:</p>
<ul>
<li>diabetes did=37 (with dimension 768x9)</li>
<li>okcupid-stem did=41440 (with dimension 50789x20)</li>
<li>mnist_784  did=554 (with dimension 70000x785)</li>
</ul>
<p>Download selected dataset using:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">did</span> <span class="o">=</span> <span class="mi">41440</span>

<span class="n">name</span> <span class="o">=</span> <span class="n">df_openml</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_openml</span><span class="o">.</span><span class="n">did</span><span class="o">==</span><span class="n">did</span><span class="p">),</span> <span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fetching database name:</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> id:</span><span class="si">{</span><span class="n">did</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">did</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>The resulting dataset has common structure which we can integrate as follows</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This is dataset &#39;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;, the target feature is &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">default_target_attribute</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;URL: </span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># display(Markdown(dataset.description))</span>
</code></pre></div>
</td></tr></table>
<p>The <code>get_data</code> method will fetch the data and return it as <code>numpy</code> arrays or as a dataframe. Here I'm return data as a <code>numpy</code> array.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">categorical_indicator</span><span class="p">,</span> <span class="n">attribute_names</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span>
    <span class="n">dataset_format</span><span class="o">=</span><span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">default_target_attribute</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Next I convert to a pandas dataframe</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataset</span><span class="p">.</span><span class="n">default_target_attribute</span><span class="w"></span>
<span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="k">data</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">columns</span><span class="o">=</span><span class="n">attribute_names</span><span class="p">)</span><span class="w"></span>
<span class="n">df</span><span class="o">[</span><span class="n">target</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span><span class="w"></span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
		
		<ul class="pager">
			
			<li class="previous"><a href="00-Outline.html">&larr; Previous (Outline)</a></li>
			
			
			
			<li class="next"><a href="02-Preprocessing.html">Next (Preprocessing) &rarr;</a></li>
			
		</ul>

	</div>
	
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="../../../style/bootstrap/js/bootstrap.min.js"></script>
	
  </body>
</html>